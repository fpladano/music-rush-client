(this["webpackJsonpreact-music-rush"]=this["webpackJsonpreact-music-rush"]||[]).push([[0],{81:function(e,t){},99:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c.n(n),a=c(26),i=c.n(a),s=(c(44),c.p+"static/media/Spotify_Logo_RGB_Black.0d1e5545.png"),o=c(100),l=c(1);function u(){return Object(l.jsxs)(o.a,{className:"d-flex flex-column justify-content-center align-items-center",style:{minHeight:"100vh"},children:[Object(l.jsx)("h1",{className:"display-1",children:"Music Rush"}),Object(l.jsx)("p",{className:"display-6 text-center text-muted",style:{marginBottom:"1.8rem"},children:"Create a Playlist just for You!"}),Object(l.jsx)("a",{className:"btn btn-success btn-lg",href:"https://accounts.spotify.com/authorize?client_id=19fbc1a2a4924852b1b82237f0e3157b&response_type=code&redirect_uri=http://localhost:3000&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state%20playlist-modify-public%20user-top-read%20user-library-read%20user-library-modify",children:"Login With Spotify"}),Object(l.jsx)("div",{children:Object(l.jsx)("img",{src:s,alt:"",style:{height:"2rem",marginTop:"2rem"}})})]})}var d=c(3),f=c(11),m=c.n(f),b="https://aqueous-garden-74884.herokuapp.com/";var h=c(28),j=c.n(h);function g(e){var t=e.userInfo;return Object(l.jsx)("div",{className:"d-flex justify-content-center align-items-center",style:{height:"2rem"},children:Object(l.jsxs)("div",{className:"d-flex align-items-center",style:{height:"100%",borderRadius:"1rem",background:"#222",padding:"2px"},children:[Object(l.jsx)("img",{src:t.image,alt:"Profile Pic",style:{height:"100%",borderRadius:"2rem",marginLeft:"0.25rem"}}),Object(l.jsx)("h5",{className:"h5 text-light",style:{marginBottom:"0",marginLeft:"0.5rem",marginRight:"0.5rem"},children:t.name})]})})}function y(e){var t=e.track,c=e.playlistTracks,r=e.onAddToPlaylist,a=Object(n.useState)(!1),i=Object(d.a)(a,2),o=i[0],u=i[1];if(Object(n.useEffect)((function(){null===c||void 0===c||c.forEach((function(e){return e.track.uri===t.uri?u(!0):u(!1)}))}),[t,c]),""===(null===t||void 0===t?void 0:t.uri))return null;var f=o?"btn-success":"btn-dark";return Object(l.jsxs)("div",{className:"d-flex justify-content-between",style:{marginBottom:"2rem"},children:[Object(l.jsx)("button",{type:"button",className:["btn ".concat(f)],onClick:r,children:o?"Added":"Add to Playlist"}),Object(l.jsx)("img",{src:s,alt:"",style:{height:"2rem"}})]})}var O=c(37);function p(e){var t=e.accessToken,c=e.trackUri,n=e.getCurrentPlayingTrack;return t?Object(l.jsx)(O.a,{token:t,uris:c||[],showSaveIcon:!1,callback:function(e){var t=e.track;return n(t)}}):null}function x(e){var t,c=e.track;return Object(l.jsxs)("div",{className:"d-flex flex-column align-items-center",children:[Object(l.jsx)("img",{src:null===c||void 0===c||null===(t=c.image[0])||void 0===t?void 0:t.albumUrl,alt:"",style:{width:"90%",maxWidth:"420px",marginBottom:"2rem"}}),Object(l.jsx)("h1",{className:"text-center",children:c.name}),Object(l.jsx)("h1",{className:"text-center text-muted",children:c.artists})]})}var v=new j.a({clientId:"19fbc1a2a4924852b1b82237f0e3157b"});function k(e){var t=function(e){var t=Object(n.useState)(),c=Object(d.a)(t,2),r=c[0],a=c[1],i=Object(n.useState)(),s=Object(d.a)(i,2),o=s[0],l=s[1],u=Object(n.useState)(),f=Object(d.a)(u,2),h=f[0],j=f[1];return Object(n.useEffect)((function(){m.a.post(b+"https://react-music-rush-server.herokuapp.com/login",{code:e}).then((function(e){a(e.data.accessToken),l(e.data.refreshToken),j(e.data.expiresIn),window.history.pushState({},null,"/")})).catch((function(){window.location="/"}))}),[e]),Object(n.useEffect)((function(){if(o&&h){var e=setInterval((function(){m.a.post(b+"https://react-music-rush-server.herokuapp.com/refresh",{refreshToken:o}).then((function(e){l(e.data.refreshToken),j(e.data.expiresIn)})).catch((function(e){window.location="/"}))}),1e3*(h-60));return function(){return clearInterval(e)}}}),[o,h]),r}(e.code),c=Object(n.useState)(),r=Object(d.a)(c,2),a=r[0],i=r[1],s=Object(n.useState)([]),u=Object(d.a)(s,2),f=u[0],h=u[1],j=Object(n.useState)(),O=Object(d.a)(j,2),k=O[0],w=O[1],T=Object(n.useState)(),P=Object(d.a)(T,2),S=P[0],N=P[1],E=Object(n.useState)(),R=Object(d.a)(E,2),I=R[0],_=R[1];return Object(n.useEffect)((function(){t&&v.setAccessToken(t)}),[t]),Object(n.useEffect)((function(){t&&v.getMe().then((function(e){N({id:e.body.id,name:e.body.display_name,image:e.body.images[0].url})})).catch((function(e){console.log(e)}))}),[t]),Object(n.useEffect)((function(){t&&v.getUserPlaylists().then((function(e){var t=!1;e.body.items.forEach((function(e){"Music Rush"===e.name&&(t=!0,v.getPlaylist(e.id).then((function(e){return _(e.body)})).catch((function(e){console.log(e)})))})),t||v.createPlaylist("Music Rush",{description:"Playlist created with React.JS by Francisco Pladano",public:!0}).then((function(e){return _(e.body)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}),[t]),Object(n.useEffect)((function(){t&&v.getMyTopTracks({limit:5}).then((function(e){var t=e.body.items;i(t.map((function(e){return e.id})))})).catch((function(e){console.log(e)}))}),[t]),Object(n.useEffect)((function(){a&&t&&v.getRecommendations({seed_tracks:a}).then((function(e){h(e.body.tracks.map((function(e){var t=e.album.images.reduce((function(e,t){return t.height>e.height?t:e}),e.album.images[0]);return{artist:e.artists[0].name,title:e.name,uri:e.uri,albumUrl:t.url}})))})).catch((function(e){console.log(e)}))}),[a,t]),Object(l.jsxs)(o.a,{className:"d-flex flex-column py-2",style:{height:"100vh"},children:[Object(l.jsx)("div",{children:S&&Object(l.jsx)(g,{userInfo:S})}),Object(l.jsx)("div",{className:"d-flex flex-grow-1 my-2 justify-content-center align-items-center",style:{overflow:"scroll"},children:k&&Object(l.jsx)(x,{track:k})}),Object(l.jsx)("div",{children:Object(l.jsx)(y,{track:k,playlistTracks:null===I||void 0===I?void 0:I.tracks.items,onAddToPlaylist:function(){var e=!1;I.tracks.items.forEach((function(t){if(t.track.uri===k.uri)return e=!0})),e||v.addTracksToPlaylist(I.id,[k.uri]).then((function(e){v.getPlaylist(I.id).then((function(e){_(e.body)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}})}),Object(l.jsx)("div",{children:Object(l.jsx)(p,{accessToken:t,trackUri:f.map((function(e){return e.uri})),getCurrentPlayingTrack:function(e){var t=e.name,c=f.filter((function(e){return e.title===t}));w({name:e.name,artists:e.artists,image:c,uri:e.uri})}})})]})}var w=new URLSearchParams(window.location.search).get("code");var T=function(){return w?Object(l.jsx)(k,{code:w}):Object(l.jsx)(u,{})};i.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(T,{})}),document.getElementById("root"))}},[[99,1,2]]]);
//# sourceMappingURL=main.88fd068a.chunk.js.map